# Инструкция по развертыванию AI-Портала техподдержки

## Быстрый старт

### 1. Подготовка окружения

1. Убедитесь, что у вас установлены:
   - Docker и Docker Compose
   - Git

2. Клонируйте репозиторий или скопируйте файлы проекта

3. Настройте переменные окружения:
   ```bash
   cp env.example .env
   ```

4. Отредактируйте файл `.env` и укажите:
   - `OPENAI_API_KEY` - ваш API ключ от OpenAI
   - Остальные настройки при необходимости

### 2. Запуск через Docker (Рекомендуется)

**Windows:**
```cmd
start.bat
```

**Linux/macOS:**
```bash
./start.sh
```

**Или вручную:**
```bash
docker-compose up -d
```

### 3. Доступ к приложению

После запуска сервисы будут доступны по адресам:

- **Frontend (веб-интерфейс):** http://localhost:3000
- **Backend API:** http://localhost:8000
- **API документация:** http://localhost:8000/docs
- **PostgreSQL:** localhost:5432

### 4. Первоначальная настройка

1. Откройте http://localhost:3000
2. Перейдите в раздел "Админка"
3. Нажмите "Переиндексировать" для создания индексов поиска
4. Проверьте, что статьи загружены из `articles.json`

## Ручная установка (без Docker)

### Backend

1. Установите Python 3.11+
2. Создайте виртуальное окружение:
   ```bash
   cd backend
   python -m venv venv
   source venv/bin/activate  # Linux/macOS
   # или
   venv\Scripts\activate     # Windows
   ```

3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

4. Настройте PostgreSQL и создайте базу данных `vectordb`

5. Импортируйте данные:
   ```bash
   python import_articles.py
   ```

6. Запустите сервер:
   ```bash
   python main.py
   ```

### Frontend

1. Установите Node.js 18+
2. Установите зависимости:
   ```bash
   cd frontend
   npm install
   ```

3. Запустите в режиме разработки:
   ```bash
   npm run dev
   ```

4. Или соберите для продакшена:
   ```bash
   npm run build
   npm run preview
   ```

## Настройка для продакшена

### 1. Безопасность

- Измените `SECRET_KEY` в `.env`
- Настройте HTTPS
- Ограничьте доступ к админке по IP или через аутентификацию
- Настройте брандмауэр для PostgreSQL

### 2. Масштабирование

- Используйте внешнюю PostgreSQL
- Настройте Redis для кеширования
- Добавьте балансировщик нагрузки для backend
- Используйте CDN для статических файлов

### 3. Мониторинг

- Настройте логирование
- Добавьте метрики (Prometheus + Grafana)
- Настройте алерты

## Структура данных

### Импорт статей

Статьи автоматически импортируются из `articles.json` при первом запуске.

Формат JSON:
```json
[
  {
    "title": "Заголовок статьи",
    "text": "Полный текст статьи",
    "url": "https://example.com/article",
    "language": "ru"
  }
]
```

### Категории

Система автоматически создает стандартные категории:
- AutoCAD
- Офисные приложения (MSO)
- Операционные системы (Windows)
- Базы данных (SQL Server)
- ИТ-Инфраструктура
- Внутренние системы и регламенты
- Система DMS МТ
- ЭДО и Финансы
- Веб и API
- Интеграции и Внешние сервисы
- Инструкции для пользователей
- Оборудование

## Устранение неполадок

### Проблемы с Docker

1. **Порты заняты:**
   - Измените порты в `docker-compose.yml`
   - Или остановите конфликтующие сервисы

2. **Ошибки при сборке:**
   - Очистите кеш Docker: `docker system prune -a`
   - Пересоберите образы: `docker-compose build --no-cache`

### Проблемы с базой данных

1. **Ошибки подключения:**
   - Проверьте настройки в `.env`
   - Убедитесь, что PostgreSQL запущен

2. **Ошибки импорта:**
   - Проверьте формат `articles.json`
   - Запустите импорт вручную: `python backend/import_articles.py`

### Проблемы с AI

1. **Ошибки OpenAI API:**
   - Проверьте правильность API ключа
   - Убедитесь, что у вас есть доступ к GPT-4
   - Проверьте лимиты API

## Поддержка

При возникновении проблем:

1. Проверьте логи: `docker-compose logs`
2. Убедитесь, что все сервисы запущены: `docker-compose ps`
3. Проверьте доступность API: http://localhost:8000/health
4. Обратитесь к документации API: http://localhost:8000/docs



